<!DOCTYPE html>
<html>

  <!DOCTYPE html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="High-performance dynamic image server in Java
">

  <title>
    Cantaloupe Image Server
    
      :: Redaction
    
  </title>

  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
  <link rel="stylesheet" type="text/css" href="/cantaloupe/css/syntax.css">
  <link rel="stylesheet" href="/cantaloupe/css/manual.css">

  <script src="/cantaloupe/scripts/jquery.min.js"></script>

</head>


  <body>

    <nav class="navbar navbar-expand-md navbar-dark bg-primary">
  <a class="navbar-brand" href="/cantaloupe/">
    <img alt="Cantaloupe" src="/cantaloupe/images/cantaloupe.png" width="40">
  </a>
  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-items" aria-controls="navbar-items" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  <div class="collapse navbar-collapse" id="navbar-items">
    <ul class="navbar-nav mr-auto">
      <li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle  active " href="#" id="user-manual-dropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
          User Manual
        </a>
        <div class="dropdown-menu" aria-labelledby="user-manual-dropdown">
          <a class="dropdown-item" href="/cantaloupe/manual/4.1/getting-started.html">4.1</a>
          <a class="dropdown-item" href="/cantaloupe/manual/4.0/getting-started.html">4.0</a>
          <a class="dropdown-item" href="/cantaloupe/manual/3.4/getting-started.html">3.4</a>
          <a class="dropdown-item" href="/cantaloupe/manual/3.3/getting-started.html">3.3</a>
          <a class="dropdown-item" href="/cantaloupe/manual/3.2/getting-started.html">3.2</a>
          <a class="dropdown-item" href="/cantaloupe/manual/3.1/getting-started.html">3.1</a>
          <a class="dropdown-item" href="/cantaloupe/manual/3.0/getting-started.html">3.0</a>
        </div>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="https://github.com/medusa-project/cantaloupe/">GitHub</a>
      </li>
    </ul>

    <ul class="navbar-nav ml-md-auto">
      <li class="nav-item">
        <a href="https://github.com/medusa-project/cantaloupe/releases.atom" title="Subscribe to Releases">
          <img width="22" height="22" src="/cantaloupe/images/feed.svg">
        </a>
      </li>
    </ul>
  </div>
</nav>


    <div class="container-fluid">
      <div class="row">
  <div class="col-sm-4 col-md-3 col-lg-2 d-print-none">
    <div class="card">
  <h5 class="card-header version">4.0</h5>
  <div class="list-group list-group-flush">
    <a class="list-group-item list-group-item-action " href="getting-started.html">Getting Started</a>

    <a class="list-group-item list-group-item-action " href="configuration.html">Configuration</a>

    <a class="list-group-item list-group-item-action " href="endpoints.html">Endpoints</a>

    <a class="list-group-item list-group-item-action " href="images.html">Images</a>

    <a class="list-group-item list-group-item-action " href="sources.html">Sources</a>

    <a class="list-group-item list-group-item-action " href="processors.html">Processors</a>

    <a class="list-group-item list-group-item-action " href="caching.html">Caching</a>

    <a class="list-group-item list-group-item-action " href="access-control.html">Access Control</a>

    <a class="list-group-item list-group-item-action " href="delegate-script.html">Delegate Script</a>

    <a class="list-group-item list-group-item-action " href="overlays.html">Overlays</a>

    <a class="list-group-item list-group-item-action  active " href="redaction.html">Redaction</a>

    <a class="list-group-item list-group-item-action " href="logging.html">Logging</a>

    <a class="list-group-item list-group-item-action " href="deployment.html">Deployment</a>

    <a class="list-group-item list-group-item-action " href="remote-management.html">Remote Management</a>
  </div>
</div>

  </div>
  <div class="col-sm-8 col-md-9 col-lg-10">
    <div class="alert alert-primary">
  <i class="fa fa-info-circle"></i>
  This version of the manual refers to an earlier version of the software.
</div>

    <h1>Redaction</h1>

<ul class="toc">
  <li><a href="#Example">Example</a></li>
  <li><a href="#Processor%20Support">Processor Support</a></li>
</ul>

<p>Redactions are black rectangles that are overlaid onto source images in order to obscure parts of them. This can be used for copyright protection, privacy protection, or censorship, without altering any source images. Different redactions can be applied to the same image dynamically for different audiences based on client IP address, cookies, and more.</p>

<p>Redactions are defined with <code>x</code>, <code>y</code>, <code>width</code>, and <code>height</code> properties corresponding to source image coordinates. Redacted regions will be blacked out at every intersecting crop region and scale.</p>

<div class="row">
  <div class="col-sm-6">
    <figure>
      <img class="img-fluid" src="images/redaction-pre-960.jpg">
      <figcaption>Original image</figcaption>
    </figure>
  </div>
  <div class="col-sm-6">
    <figure>
      <img class="img-fluid" src="images/redaction-post-960.jpg">
      <figcaption>Redactions applied</figcaption>
    </figure>
  </div>
</div>

<p>The redaction feature works via the <a href="delegate-script.html">delegate script</a>. With the delegate script enabled, <code>redactions.enabled</code> must be set to <code>true</code> in the configuration file. The delegate script must implement a method called <code>redactions()</code> that returns an array of source image redaction coordinates in response to a particular request.</p>

<h2 id="Example">Example</h2>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="k">class</span> <span class="nc">CustomDelegate</span>
  <span class="k">def</span> <span class="nf">redactions</span><span class="p">(</span><span class="n">options</span> <span class="o">=</span> <span class="p">{})</span>
    <span class="n">redactions</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># Add two redactions to an image with an identifier of "sample" for all</span>
    <span class="c1"># clients except localhost.</span>
    <span class="k">if</span> <span class="n">context</span><span class="p">[</span><span class="s1">'identifier'</span><span class="p">]</span> <span class="o">==</span> <span class="s1">'sample'</span>
      <span class="k">unless</span> <span class="sx">%w(127.0.0.1 ::1/128)</span><span class="p">.</span><span class="nf">include?</span><span class="p">(</span><span class="n">context</span><span class="p">[</span><span class="s1">'client_ip'</span><span class="p">])</span>
        <span class="n">redactions</span> <span class="o">&lt;&lt;</span> <span class="p">{</span>
            <span class="s1">'x'</span> <span class="o">=&gt;</span> <span class="mi">50</span><span class="p">,</span>
            <span class="s1">'y'</span> <span class="o">=&gt;</span> <span class="mi">65</span><span class="p">,</span>
            <span class="s1">'width'</span> <span class="o">=&gt;</span> <span class="mi">120</span><span class="p">,</span>
            <span class="s1">'height'</span> <span class="o">=&gt;</span> <span class="mi">105</span>
        <span class="p">}</span>
        <span class="n">redactions</span> <span class="o">&lt;&lt;</span> <span class="p">{</span>
            <span class="s1">'x'</span> <span class="o">=&gt;</span> <span class="mi">673</span><span class="p">,</span>
            <span class="s1">'y'</span> <span class="o">=&gt;</span> <span class="mi">812</span><span class="p">,</span>
            <span class="s1">'width'</span> <span class="o">=&gt;</span> <span class="mi">1320</span><span class="p">,</span>
            <span class="s1">'height'</span> <span class="o">=&gt;</span> <span class="mi">620</span>
        <span class="p">}</span>
      <span class="k">end</span>
    <span class="k">end</span>
    <span class="n">redactions</span>
  <span class="k">end</span>
<span class="k">end</span></code></pre></figure>

<h2 id="Processor Support">Processor Support</h2>

<p>Not all processors support redaction; see the <a href="processors.html#Supported%20Features">table of processor-supported features</a>.</p>

  </div>
</div>


      <footer>
</footer>

<script src="/cantaloupe/scripts/bootstrap.min.js"></script>
<script src="/cantaloupe/scripts/base.js"></script>

    </div>

  </body>

</html>
